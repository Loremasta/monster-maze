00000 OPTION DIALECT BASICPLUS
00090 REM MONSTER MAZE GAME
00095 REM WRITTEN BY TERRY OBRIEN...WHO EVER HE IS....
00100 REM SLIGHTLY MODIFIED BY DOUGLAS H. QUEBBEMAN
00110 REM FIXED FOR 8BITWORKSHOP.COM BY THE LOREMASTER
00140 DIM M$(26,3), L$(4), D$(4), T$(3,6), S(4)
00150 DIM P(9),H$(42), A(100)
00152 REM
00154 DEF FNL(X) = LOG(X)/LOG(10)
00160 L$(1)=" GLOOM"
00170 L$(2)=" A WALL"
00180 L$(3)=" A DOOR"
00190 L$(4)=" DAYLIGHT"
00200 REM
00210 FOR I=1 TO 26
00220   FOR J=1 TO 3
00230       READ M$(I,J)
00240   NEXT J
00250 NEXT I
00260 REM
00270 D$(1)=" NORTH"
00280 D$(2)=" EAST"
00290 D$(3)=" SOUTH"
00300 D$(4)=" WEST"
00310 REM
00320 DEF FNP(T1) = VAL( MID$( M$(Y1,T1),X1,1) )
00330 REM    POSITION IN STRING ARRAY
00340 DEF FND(X)=ABS(X-87)*ABS(X-83)*ABS(X-69)*ABS(X-78)
00350 REM  DIRECTION CHECKER FUNCTION
00360 FOR I=1 TO 3
00370   FOR J=1 TO 6
00380     READ T$(I,J)
00390   NEXT J
00400 NEXT I
00410 REM
00420 READ H$(1)
00430 FOR I=2 TO 11
00440   READ H$(I)
00450   H$(I+10)=H$(I)
00460 NEXT I
00470 S=0
00480 REM  INTRO
00490 PRINT" ************************************************"
00500 PRINT" *************** MONSTER MAZE *******************"
00510 PRINT" ************************************************"
00520 PRINT
00530 PRINT" DO YOU NEED HELP";
00540 INPUT A$
00550 IF MID$(A$,1,1)<>"Y" THEN 01440
00560 PRINT
00570 REM
00580 REM  START HELP
00590 PRINT"    YOU ARE ABOUT TO ENTER THE VAST DUNGEON OF CAER OMN, A ONCE"
00600 PRINT" GREAT CASTLE, BUT NOW IN RUINS.  YOU ARE TO SEARCH THE DUNGEON"
00610 PRINT" FOR MONEY, GEMS, AND ADVENTURE, AND TO COME OUT ALIVE AT THE "
00620 PRINT" OTHER END OF THE MAZE.  TO DO THIS, STUDY AND USE THE COMANDS"
00630 PRINT" LISTED BELOW."
00640 PRINT
00650 PRINT"   MODE";TAB(11);"COMMAND";TAB(20);"COMMENT"
00660 PRINT" NORMAL";TAB(11);"N,S,W,E";TAB(20);"DIRECTION OF TRAVEL"
00670 PRINT TAB(11);"O";TAB(20);"OPEN DOOR, USES DIRECTION"
00680 PRINT TAB(11);"B";TAB(20);"TOGGLES BRIEF MODE, ON=INHIBIT LISTING OF LOC."
00690 PRINT TAB(11);"D";TAB(20);"PERSONAL DATA"
00700 PRINT TAB(11);"C";TAB(20);"USE A CLERICAL CHANT"
00710 PRINT" FIGHTING";TAB(11);"F";TAB(20);"FIGHT OPPONENT, USES DIRECTION"
00720 PRINT TAB(11);"R";TAB(20);"RUN (ONLY IN CORRIDOR), USES DIRECTION"
00730 PRINT TAB(11);"M";TAB(20);"THROW MAGIC SPELL"
00740 PRINT TAB(11);"C";TAB(20);"SAY CLERICAL CHANT"
00750 PRINT TAB(11);"D";TAB(20);"GET PERSONAL DATA"
00760 PRINT
00770 PRINT"    YOUR PERSONAL STATISTICS ARE YOUR KEY TO COMING OUT ALIVE.  THE"
00780 PRINT" HIGHER THE INDEX, FROM 1-20, THE BETTER YOU ARE, AND THE MORE"
00790 PRINT" LIKELY YOU'LL COME OUT ALIVE.  THESE DO NOT CHANGE.  YOUR HITS,"
00800 PRINT" HOWEVER, ARE A MEASURE OF HOW MANY HITS YOU CAN RECIEVE FROM AN"
00810 PRINT" OPPONENT AND LIVE, AND CAN CHANGE AS YOU FIGHT SOMETHING, WHICH"
00820 PRINT" DEPLETES THEM, OR CURE THEM, WHICH INCREASES THEM. IF THEY DROP"
00830 PRINT" TO ZERO, YOU ARE DEAD !!!!"
00840 PRINT
00850 PRINT"    TO HELP YOU GET THROUGH THE DUNGEON, A KINDLY WIZARD HAS HELPED"
00860 PRINT" YOU LEARN SOME SIMPLE, BUT EFFECTIVE, SPELLS.  ALSO, A FRIENDLY"
00870 PRINT" PRIEST HAS TAUGHT YOU SOME CLERICAL CHANTS WHICH MAY HELP YOU."
00880 PRINT" THEY ARE:"
00890 PRINT
00900 PRINT"    MAGIC SPELLS"
00910 PRINT"  1. SLEEP  (PUTS OPPONENT TO SLEEP)"
00920 PRINT"  2. CHARM  (MAKES MEN AND GOBLIN-TYPES KILL THEMSELVES)"
00930 PRINT"  3. LIGHTNING BOLT  (DETROYS ENEMY, MAY FAIL)"
00940 PRINT"  4. MAGIC ARROW  (CREATES ARROW TO DESTROY ENEMY, NOT VERY ACCURATE)"
00950 PRINT"  5. BLAST BOLT  (DETROYS ENEMY, USES ALL MAGIC YOU HAVE)"
00960 PRINT
00970 PRINT"    CLERICAL CHANTS"
00980 PRINT"  1. PROTECTION  (WARDS FIRST ATTACK OF ENEMY)"
00990 PRINT"  2. HOLD  (FREEZES MEN AND GOBLIN-TYPES)"
01000 PRINT"  3. PRAY  (WORKS ONLY ON UNDEAD, DRIVES THEM AWAY)"
01010 PRINT"  4. CURE WOUNDS  (MAKES YOURSELF STRONGER AFTER A FIGHT)"
01020 PRINT"  5. DISPELL MYTH  (CAUSES MYTHICAL MONSTERS TO DISAPPEAR)"
01030 PRINT
01040 PRINT"    EACH SPELL OR CHANT TAKES A CERTAIN AMOUNT OF POWER FROM THE"
01050 PRINT" STORE OF MAGIC OR CLERICAL POWER YOU STARTED WITH.  THIS CAN"
01060 PRINT" BE REPLENSIHED BY KILLING A MONSTER OR FINDING A MAGIC JEWEL OR"
01070 PRINT" GEM.  *WARNING*  THE STRONGER THE MONSTER IS, THE LESS EFFECTIVE"
01080 PRINT" YOUR SPELLS ARE."
01090 PRINT
01100 PRINT"    THE MONSTERS YOU MAY RUN INTO ARE DIVIDED INTO THE FOLLOWING"
01110 PRINT" CATEGORIES:"
01120 PRINT
01130 PRINT"   1. ENCHANTED MEN, LEVELS 1 THROUGH 6"
01140 PRINT"   2. GOLBIN TYPES (KOBOLDS, GOBLINS, ORCS, HOBGOBLINS, TROLLS,"
01150 PRINT"          AND OGRES)"
01160 PRINT"   3. UNDEAD (SKELETONS, ZOMBIES, SPIRITS, WRAITHES, GHOULS, AND"
01170 PRINT"          VAMPIRES)"
01180 PRINT"   4. MYTHICAL MONSTERS (STRIGES, HARPIES, MEDUSAS, WYVERNS,"
01190 PRINT"          BASILISKS, AND DRAGONS)"
01200 PRINT
01210 PRINT"    THE HIGHER THE MONSTER IS ON THE LIST, THE STRONGER IT IS, AND"
01220 PRINT" THE MORE HITS IT WILL TAKE FROM YOU."
01230 PRINT
01240 PRINT"     WHEN PLAYING, THE FOLLOWING POINTS SHOULD BE KNOWN:"
01250 PRINT
01260 PRINT"     1. TO GO THROUGH A DOOR, YOU MUST OPEN IT WITH THE 'O'"
01270 PRINT"  COMMAND.  AFTER GOING THROUGH IT, IT WILL CLOSE BEHIND YOU"
01280 PRINT"  BY MAGIC."
01290 PRINT
01300 PRINT"     2. WHEN A MONSTER ATTACKS YOU, IT WILL DO SO ONLY FROM"
01310 PRINT"  THE GLOOM OF AN EMPTY SPACE."
01320 PRINT
01330 PRINT"     3. WHEN FIGHTING A MONSTER, YOU MUST CHOOSE WHICH DIRECTION"
01340 PRINT"  TO SWING YOUR SWORD.  IF THAT DIRECTION IS THE ONE THE MONSTER"
01350 PRINT"  IS COMING FROM, ITS ATTACK WILL BE COUNTERED AND LESSENED.  IF"
01360 PRINT"  IT IS IN THE OPPOSITE DIRECTION, YOUR ATTACK WILL BE DIMISHED."
01370 PRINT
01380 PRINT"     4. IF YOU GET THROUGH THE MAZE TO THE OTHER SIDE, YOU WILL"
01390 PRINT"  RECIEVE 1000 PIECES OF GOLD."
01400 PRINT
01410 PRINT"     5. IF YOU GET OUT, AND WANT TO TRY AGAIN, YOUR MONEY WILL BE"
01420 PRINT"  SOLD FOR EXPERIENCE AND MAGIC AND CLERICAL POWER AND HITS."
01430 PRINT
01440 REM  CREATE BODY
01450 FOR I=1 TO 4
01460   P(I)=INT(20*RND(0))+1
01470 NEXT I
01480 P(5)=INT(20*RND(0))+1
01490 P(6)=INT(20*RND(0))+1
01500 P(7)=INT(15*RND(0)+1)
01501 H=P(7)
01510 REM
01520 GOSUB 05610
01530 PRINT
01540 PRINT" DO YOU LIKE YOURSELF";
01550 INPUT A$
01560 IF MID$(A$,1,1)="N" THEN 01440
01570 REM
01580 X=13
01590 Y=1
01600 D=1
01610 IF S=1 THEN 01640
01620 S1=INT(24*RND(0))+1
01630 S2=INT(24*RND(0))+1
01640 REM
01650 P=0
01660 B=1
01670 C=0
01671 M=0
01680 REM
01690 REM  GAME
01700 REM
01710 GOSUB 05360
01720 REM
01730 ON FNP(3) GOTO 01740, 01770, 01750
01740 IF RND(0)>.2 THEN 01770
01750 GOSUB 06010
01760 REM
01770 IF A<>1 THEN 01800
01780 PRINT"  * * *  UNDER ATTACK";
01790 REM
01800 PRINT" CHOICE";
01810 INPUT A$
01820 IF A$="" THEN 01840
01830 CHANGE A$ TO A
01831 PRINT A(1)
01840 IF A=1 THEN 01940
01850 REM
01860 IF FND(A(1))=0 THEN 02180
01870 IF A(1)=79 THEN 02020
01880 IF A(1)=66 THEN 02950
01890 IF A(1)=68 THEN 02880
01900 IF A(1)=67 THEN 03670
01910 PRINT"   NO SUCH COMMAND"
01920 GOTO 01800
01930 REM
01940 IF A(1)=77 THEN 03060
01950 IF A(1)=67 THEN 03670
01960 IF A(1)=82 THEN 04280
01970 IF A(1)=70 THEN 04550
01980 IF A(1)=68 THEN 02880
01990 PRINT"   NO"
02000 GOTO 01770
02010 REM
02020 REM  OPEN DOOR AND MOVE
02030 PRINT" IN WHICH DIRECTION";
02040 INPUT A$
02050 CHANGE A$ TO A
02060 IF FND(A(1))<>0 THEN 01770
02070 GOSUB 05840
02080 REM
02090 REM  CHECK FOR DOOR
02100 IF S(D2)<>3 THEN 02140
02110 D=D2
02120 ON D2 GOTO 02310, 02350, 02390, 02430
02130 REM
02140 REM ERROR
02150 PRINT" NO DOOR THERE."
02160 GOTO 01770
02170 REM
02180 REM  MOVING
02190 GOSUB 05840
02200 REM
02210 IF S(D2)=1 THEN 02270
02220 IF S(D2)=4 THEN 02270
02230 REM ERROR
02240 PRINT" YOU CAN'T WALK THROUGH";L$(S(D2))
02250 GOTO 01770
02260 REM
02270 D=D2
02280 ON D2 GOTO 02310, 02350, 02390, 02430
02290 REM
02300 REM ROUTINES
02310 REM NORTH
02320 Y=Y+1
02330 GOTO 02470
02340 REM
02350 REM EAST
02360 X=X+1
02370 GOTO 02470
02380 REM
02390 REM SOUTH
02400 Y=Y-1
02410 GOTO 02470
02420 REM
02430 REM WEST
02440 X=X-1
02450 GOTO 02470
02460 REM
02470 REM CHECKS
02480 IF ABS(X-13)+ABS(Y-25)<>0 THEN 02560
02490 PRINT
02500 PRINT"      YOU   MADE   IT"
02510 PRINT" FOR MAKING IT OUT OF THE MAZE, YOU GET 1000 PIECES OF GOLD !!"
02520 PRINT
02530 P(9)=P(9)+1000
02540 GOTO 02660
02550 REM
02560 IF ABS(X-S1)+ABS(Y-S2)<>0 THEN 02620
02570 PRINT"      YOU FOUND THE MAGIC SWORD"
02580 S=1
02590 S1=0
02591 S2=0
02600 REM
02610 REM
02620 IF Y>0 THEN 01690
02630 PRINT
02640 PRINT"   THAT'S THE SAME PLACE YOU ENTERED FROM !!!"
02650 REM
02660 REM    *** END ***
02670 PRINT
02680 PRINT" STATISTICS AT END ARE:"
02690 GOSUB 05610
02700 PRINT" EXPERIENCE  =";P(8);TAB(25);"MONEY          =";P(9)
02710 PRINT
02720 PRINT" DO YOU WANT TO GO AGAIN";
02730 INPUT A$
02740 PRINT
02750 IF MID$(A$,1,1)<>"Y" THEN 02850
02760 REM
02770 P(8)=P(8)+P(9)
02780 P(9)=0
02790 P(5)=P(5)+(INT(RND(0)*FNL(P(8)+.5)))
02800 P(6)=P(6)+(INT(RND(0)*FNL(P(8)+.5)))
02810 P(7)=H + (INT(RND(0)*FNL(P(8)+.5)/2))
02820 REM
02830 GOTO 01580
02840 REM
02850 PRINT" HOPE YOU HAD FUN  ...  GOOD BYE"
02860 STOP
02870 REM
02880 REM DATA
02890 REM ************
02900 GOSUB 05610
02910 PRINT" EXPERIENCE  =";P(8);TAB(25);"MONEY          =";P(9)
02920 PRINT
02930 GOTO 01770
02940 REM
02950 REM BRIEF MODE
02960 PRINT
02970 IF B=-1 THEN 03010
02980 PRINT"  BRIEF MODE  *ON*"
02990 GOTO 03020
03000 REM
03010 PRINT"  BRIEF MODE  *OFF*"
03020 B=-B
03030 PRINT
03040 GOTO 01770
03050 REM
03060 REM MAGIC SPELL
03070 PRINT
03080 IF M>3 THEN 03140
03090 PRINT"  MAGIC SPELLS"
03100 PRINT"  1. SLEEP"; TAB(30);"4. MAGIC ARROW"
03110 PRINT"  2. CHARM"; TAB(30);"5. BLAST BOLT"
03120 PRINT"  3. LIGHTNING BOLT"
03130 PRINT
03140 PRINT" WHICH SPELL ?";
03150 INPUT A$
03152 S = VAL(A$)
03160 IF S=0 THEN 01770
03170 IF S<1 THEN 03130
03180 IF S>5 THEN 03130
03190 IF ABS(S)<>INT(S) THEN 03130
03200 PRINT
03210 M=M+1
03220 ON S GOTO 03240, 03320, 03400, 03490, 03580
03230 REM
03240 REM  SLEEP
03250 IF RND(0)*(P(2)/20)<.1*L THEN 04520
03260 IF L=3 THEN 04520
03270 IF P(5)<L*2 THEN 04520
03280 P(5)=P(5)-2*L
03290 PRINT" MONSTER IS ASLEEP ... AND";
03300 GOTO 05210
03310 REM
03320 REM CHARM
03330 IF L>2 THEN 04520
03340 IF P(5)<3 THEN 04520
03350 P(5)=P(5)-3
03360 IF RND(0)<.3*(P(2)/10) THEN 04520
03370 PRINT" IT IS CHARMED ... AND";
03380 GOTO 05210
03390 REM
03400 REM L-BOLT
03410 IF P(5)<5 THEN 04520
03420 P(5)=P(5)-5
03430 IF RND(0)<.5*(P(2)/10) THEN 03460
03440 PRINT"       F I Z Z L E"
03450 GOTO 04520
03460 PRINT"       S*H*A*Z*A*M";
03470 GOTO 05210
03480 REM
03490 REM ARROW
03500 IF P(5)<8 THEN 04520
03510 P(5)=P(5)-8
03520 PRINT" ARROW FLYING TOWARDS TARGET AND ...";
03530 IF (P(2)/10)*2>L*RND(0) THEN 05210
03540 PRINT" IT DUCKS PART OF IT !!!"
03550 F=F*(.5*RND(0)+.5)
03560 GOTO 04550
03570 REM
03580 REM B-BOLT
03590 IF P(5)<1 THEN 04520
03600 F=F-INT( (P(2)/10) *P(5))
03610 P(5)=0
03620 PRINT" BOLT AWAY AND ...";
03630 IF F<=0 THEN 05210
03640 PRINT" IT MISSED !!"
03650 GOTO 04550
03660 REM
03670 REM  CLERICAL CHANTS
03680 PRINT
03690 IF C>3 THEN 03750
03700 PRINT"  CLERICAL CHANTS"
03710 PRINT"  1. PROTECTION"; TAB(30);"4. CURE WOUNDS"
03720 PRINT"  2. HOLD"; TAB(30);"5. DISPELL MYTH"
03730 PRINT"  3. PRAY"
03740 PRINT
03750 PRINT" WHICH CHANT ?";
03760 INPUT A$
03762 S = VAL(A$)
03770 IF S=0 THEN 01770
03780 IF S<1 THEN 03740
03790 IF S>5 THEN 03740
03800 IF ABS(S)<>INT(S) THEN 03740
03810 PRINT
03820 C=C+1
03830 ON S GOTO 03850, 03950, 04030, 04120, 04180
03840 REM
03850 REM PROTECTION
03860 IF P(6)<2 THEN 03910
03870 P(6)=P(6)-2
03880 P=1
03890 PRINT" PROTECTION ON"
03900 GOTO 03920
03910 PRINT" NOT ENOUGH POWER, FOOL!"
03920 PRINT
03930 ON A+1 GOTO 01770, 04550
03940 REM
03950 REM HOLD
03960 IF A=0 THEN 03750
03970 IF P(6)<3 THEN 04520
03980 P(6)=P(6)-3
03990 IF RND(0)<.1*(P(2)/10) THEN 04520
04000 PRINT" IT IS HELD ...";
04010 GOTO 05210
04020 REM
04030 REM PRAY
04040 IF A=0 THEN 03750
04050 IF L<>2 THEN 04520
04060 IF P(6)<5 THEN 04520
04070 P(6)=P(6)-5
04080 PRINT" YOU DROVE IT AWAY !"
04090 A=0
04100 GOTO 05250
04110 REM
04120 REM CURE WOUNDS
04130 IF P(6)<6 THEN 03750
04140 P(6)=P(6)-6
04150 P(7)=P(7)+3+INT(7*RND(0))
04160 GOTO 03750
04170 REM
04180 REM DISPELL MYTH
04190 IF A=0 THEN 03750
04200 IF L<>4 THEN 04520
04210 IF P(6)<9 THEN 04520
04220 P(6)=P(6)-9
04230 IF RND(0)*R>(P(2)/10)*2.5 THEN 04520
04240 PRINT" MONSTER DISPELLED"
04250 A=0
04260 GOTO 05250
04270 REM
04280 REM RUN
04290 IF FNP(3)<>1 THEN 04330
04300 PRINT" YOU CAN'T RUN IN A ROOM!"
04310 GOTO 01770
04320 REM
04330 IF 5*RND(0)>L THEN 04520
04340 PRINT" IN WHICH DIRECTION";
04350 INPUT A$
04360 CHANGE A$ TO A
04370 IF FND(A(1))<>0 THEN 04340
04380 GOSUB 05840
04390 REM
04400 IF D1=D2 THEN 04500
04410 IF S(D2)<>1 THEN 04460
04420 PRINT" YOU ESCAPED !!!"
04430 A=0
04431 T=0
04440 ON D2 GOTO 02310, 02350, 02390, 02430
04450 REM
04460 PRINT" YOU CAN'T RUN THROUGH";L$(S(D2));" !!!"
04470 PRINT" THE MONSTER HAS CAUGHT UP WITH YOU !!!"
04480 GOTO 04550
04490 REM
04500 PRINT" YOU RAN INTO IT !!!"
04510 REM
04520 REM  NO LUCK
04530 PRINT" NO LUCK,  YOU HAVE TO FIGHT."
04540 REM
04550 REM FIGHT
04560 REM
04570 PRINT" SWING IN WHICH DIRECTION";
04580 INPUT A$
04590 CHANGE A$ TO A
04600 IF FND(A(1))<>0 THEN 04570
04610 GOSUB 05840
04620 H1=INT( P(1)*3*RND(0)*.25 + (S*5) )
04630 H2=INT( (F*RND(0))/INT(P(4)/10 +1.5) )
04640 IF H1<=P(7)+(S*5) THEN 04670
04650   H1=P(7)+(S*5)
04660   REM
04670 IF D1<>D2 THEN 04710
04680   H2=INT(H2/2)
04690   GOTO 04740
04700   REM
04710 IF ABS(D1-D2)<>1 THEN 04740
04720   H1=INT(H1/2)
04730   REM
04740 REM  CHOOSE
04750 PRINT TAB(6);
04760 IF P=1 THEN 04930
04770 IF P(3)/20>RND(0) THEN 04930
04780 REM
04790 REM  FIRST TO MONSTER
04800 PRINT" ";H$(H2+1);
04810 R1=H2
04820 GOSUB 05070
04830 P(7)=P(7)-H2
04840 IF P(7)<=0 THEN 05140
04850 PRINT" ";H$(H1+1);
04860 R1=H1
04870 GOSUB 05070
04880 F=F-H1
04890 IF F<=0 THEN 05210
04900 PRINT P(7);"HITS LEFT TO YOU"
04910 GOTO 04570
04920 REM
04930 REM FIRST TO SELF
04940 PRINT" ";H$(H1+1);
04950 R1=H1
04960 GOSUB 05070
04970 F=F-H1
04980 IF F<=0 THEN 05210
04990 PRINT" ";H$(H2+1);
05000 R1=H2
05010 GOSUB 05070
05020 P(7)=P(7)-H2
05030 IF P(7)<=0 THEN 05140
05040 PRINT P(7);"HITS LEFT TO YOU"
05050 GOTO 04570
05060 REM
05070 REM  EMPHASIS
05080 PRINT" ";
05090 FOR I=1 TO INT((R1/3)+.75)
05100   PRINT"!";
05110 NEXT I
05120 RETURN
05130 REM
05140 REM DEAD!
05150 PRINT
05160 P=0
05161 T=0
05162 P=0
05170 PRINT" THE FORCES OF CHAOS HAVE TRIUMPHED AGAIN!"
05180 P(7)=0
05181 P(8)=0
05182 P(9)=0
05190 GOTO 02660
05200 REM
05210 REM  CALC SCORE IF ALIVE
05220 PRINT" YOU KILLED IT !!!!!"
05230 PRINT
05240 REM
05250 REM  CALC NEW EXP.
05260 A=0
05261 P=0
05270 P(8)=P(8)+(10*L*R)
05280 P(5)=P(5)+INT(L*RND(0))+1
05290 P(6)=P(6)+INT(L*RND(0))+1
05300 REM
05310 REM TREASURE
05320 IF T<>1 THEN 05340
05330 GOSUB 05720
05340 GOTO 01770
05350 REM
05360 REM  LOCATION SUBROUTINE
05370 PRINT
05380 X1=X
05390 Y1=Y+1
05400 S(1)=FNP(1)
05410 X1=X+1
05420 Y1=Y
05430 S(2)=FNP(2)
05440 X1=X
05450 Y1=Y
05460 S(3)=FNP(1)
05470 S(4)=FNP(2)
05480 IF B=-1 THEN 05590
05490 PRINT" YOU ARE IN A ";
05500 IF FNP(3)<>1 THEN 05530
05510   PRINT "ROOM"
05520   GOTO 05540
05530   PRINT "CORRIDOR"
05540 REM
05550 PRINT" TO THE NORTH IS";L$(S(1));TAB(27);"TO THE SOUTH IS";L$(S(3))
05560 PRINT" TO THE EAST  IS";L$(S(2));TAB(27);"TO THE WEST  IS";L$(S(4))
05570 PRINT" YOU ARE FACING";D$(D)
05580 PRINT
05590 RETURN
05600 REM
05610 REM  OUTPUT  DATA
05620 PRINT
05630 PRINT" STRENGTH    =";P(1);TAB(25);"INTELLIGENCE   =";P(2)
05640 PRINT" DEXTERITY   =";P(3);TAB(25);"CONSTITUTION   =";P(4)
05650 PRINT" MAGIC POWER =";P(5);TAB(25);"CLERICAL POWER =";P(6)
05660 PRINT" HITS        =";P(7);
05670 IF P=0 THEN 05690
05680 PRINT TAB(25);"PROTECTION     = ON";
05690 PRINT
05700 RETURN
05710 REM
05720 REM  PICK TREASURE
05730 P(9)=P(9)+V
05740 T=0
05750 IF V<99 THEN 05810
05760 IF RND(0)>.3 THEN 05810
05770 P(5)=P(5)+INT(5*RND(0)*(FNL(V)-1))
05780 P(6)=P(6)+INT(5*RND(0)*(FNL(V)-1))
05790 P(7)=P(7)+INT(6*RND(0))
05800 REM  ONLY FOR MAGIC JEWEL OR GEM
05810 P(8)=P(8)+V
05820 RETURN
05830 REM
05840 REM DIRECTION
05850 IF A(1)=87 THEN 05980
05860 IF A(1)=83 THEN 05950
05870 IF A(1)=69 THEN 05920
05880 REM
05890 D2=1
05900 RETURN
05910 REM
05920 D2=2
05930 RETURN
05940 REM
05950 D2=3
05960 RETURN
05970 REM
05980 D2=4
05990 RETURN
06000 REM
06010 REM  ATTACK AND TREASURE ROUTINE
06020 R1=RND(0)
06030 A=0
06031 T=0
06040 IF R1>.6 THEN 06100
06050 PRINT"    ";
06060 GOSUB 06210
06070 D1=INT(4*RND(0))+1
06080 IF S(D1)<>1 THEN 06070
06090 REM
06100 IF R1<.4 THEN 06140
06110 IF FNP(3)>1 THEN 06140
06120 GOSUB 06480
06130 REM
06140 IF A+T<=0 THEN 06190
06150 PRINT"."
06160 PRINT
06170 IF A*T+T<>1 THEN 06190
06180 GOSUB 05720
06190 RETURN
06200 REM
06210 REM ATTACK
06220 A=1
06230 PRINT" UNDER ATTACK BY A";
06240 REM
06250 R2=RND(0)
06260 IF R2>.3 THEN 06330
06270 R=INT(6*RND(0))+1
06280 PRINT "N ENCHANTED MAN OF LEVEL";R;
06290 L=1
06300 F=2*(L+R)
06310 RETURN
06320 REM
06330 IF R2>.6 THEN 06370
06340   L=2
06350   GOTO 06430
06360   REM
06370 IF R2>.85 THEN 06410
06380   L=3
06390   GOTO 06430
06400   REM
06410 L=4
06420 REM
06430 R=INT(6*RND(0))+1
06440 PRINT T$(L-1,R);
06450 F=2*(L+R)
06460 RETURN
06470 REM
06480 REM TREASURE
06490 T=1
06500 IF A=1 THEN 06530
06510   PRINT" YOU FOUND";
06520   GOTO 06550
06530   PRINT","
06540   PRINT" GUARDING";
06550 REM
06560 R2=RND(0)
06570 IF R2>.45 THEN 06620
06580   V=10*(INT(8*RND(0))+1)
06590   PRINT V;"GOLD PIECES";
06600   RETURN
06610   REM
06620 IF R2>.75 THEN 06670
06630   V=10*(INT(8*RND(0))+1)
06640   PRINT V*10;"SILVER PIECES";
06650   RETURN
06660   REM
06670 IF R2>.9 THEN 06740
06680   V=100*(INT(4*RND(0))+1)
06690   PRINT V/100;"GEM";
06700   IF V<=100 THEN 06720
06710     PRINT"S";
06720   RETURN
06730   REM
06740 V=1000*(INT(2*RND(0))+2)
06750 PRINT V/1000;"JEWEL PIECES";
06760 RETURN
06770 REM
06780 REM DATA
06790 REM   MAZE DATA
06800 DATA "2222222222224222222222222","21121121211222112121311112"
06810 DATA "1111111111112111111122322"
06820 DATA "2311111111311321111123221","21221131312122122121212122"
06830 DATA "1111111111113111111111112"
06840 DATA "1113221111111113121111111","21222131212122121321312122"
06850 DATA "1112111111112111121111112"
06860 DATA "2231112322221222213232321","21122123111111111121213122"
06870 DATA "1112111223222322221111112"
06880 DATA "1111111222322232221111111","21132121312112121121213122"
06890 DATA "1112111111111111111111113"
06900 DATA "2221221111111111111122221","21123121213112131131211322"
06910 DATA "1112111111111111111111112"
06920 DATA "3111112222222222222221113","22122131212131121212121212"
06930 DATA "1113111111111111111111111"
06940 DATA "1221111111111111111111111","21132121312121121212131212"
06950 DATA "1112111111111111111111111"
06960 DATA "1111223211112231112231131","22122121212132121221211132"
06970 DATA "1112111111112111111122221"
06980 DATA "1231122132221112311112221","22122131212122121221231112"
06990 DATA "2112111111112111111121111"
07000 DATA "1111111221111111132112111","22122121213122131213221312"
07010 DATA "2112111111113111111131111"
07020 DATA "1221232222221222111112223","22121111111111112212331212"
07030 DATA "3112223222222222111121111"
07040 DATA "1111222323231223323211111","22122121212122113121221312"
07050 DATA "2112111111112111111121111"
07060 DATA "1111111111111111111112221","23133121323122132121331322"
07070 DATA "2112111111113111111121111"
07080 DATA "1232111111111222211111111","22112121313122131231221232"
07090 DATA "3111111111112111111121111"
07100 DATA "1111222222221111122222311","22112211212122121231212222"
07110 DATA "2111111111112111121111111"
07120 DATA "1222111111111112211111121","23121211212133131121312112"
07130 DATA "2111111111112112321111111"
07140 DATA "1111122332232223222211111","22121211222112112121212112"
07150 DATA "2111111121111111111111111"
07160 DATA "1111111111121111111132332","22121311322222112131221212"
07170 DATA "2111111121111111111121111"
07180 DATA "1233223211342222233211111","22122121222222112131221212"
07190 DATA "2112111121111111111121111"
07200 DATA "3111111111131111111113211","22122121221223113121221212"
07210 DATA "2112111121111111111121111"
07220 DATA "1111232212233222222211132","23131111121221111111121212"
07230 DATA "2112223221112222322221111"
07240 DATA "1222222221132222222231111","22112121112221121311121212"
07250 DATA "3111111111111111111111111"
07260 DATA "1111111312113111122112222","22113132211122121213121112"
07270 DATA "2111111111113111111111111"
07280 DATA "1223111322221112211111111","21113121111132131112131112"
07290 DATA "2222111111112111111111111"
07300 DATA "2222222222224222222222222"
07310 DATA " "," "
07320 REM MONSTERS
07330 DATA " KOBOLD"," GOBLIN","N ORC"," HOBGOBLIN"," TROLL","N OGRE"
07340 DATA " SKELETON"," ZOMBIE"," SPIRIT"," WRAITHE"," GHOUL"," VAMPIRE"
07350 DATA " STRIGE"," HARPY"," MEDUSA"," WYVERN"," BASILISK"," DRAGON"
07360 REM  HIT DATA TABLE
07370 DATA "SWISH","CLANG","SLASH","HACK","RIP","STAB"
07380 DATA "SLICE","CHOP","THRUST","PARRY","CUT"
07390 DATA "REND"
07400 END
